<ion-header>
    <ion-toolbar class="ion-text-center">
        <ion-buttons slot="start">
        <ion-back-button defaultHref="/menu-principal" text=""></ion-back-button>
        </ion-buttons>
        <ion-title class="ion-text-uppercase">Importar Acompanhamento</ion-title>
        <ion-buttons slot="end">
        <ion-menu-button menuId="main-content"></ion-menu-button>
        </ion-buttons>
    </ion-toolbar>   
</ion-header>
<ion-content>
    <ion-searchbar [(ngModel)]="filtroLista" (keyup)="filtrarLista($event)" (ionCancel)="cancelaFiltroLista()" (ionClear)="cancelaFiltroLista()" cancelButtonText="Cancelar" placeholder="Paciente, Carteira ou Senha" [debounce]="250" inputmode="text" type="text" enterkeyhint="search" animated #searchInput></ion-searchbar> 
    <ion-chip *ngIf="listaAcompanhamentosFiltrados.length > 0" (click)="marcarDesmarcarTodos()">
        <ion-icon name="checkmark-circle" *ngIf="!flgMarcarTodos"></ion-icon>
        <ion-label *ngIf="!flgMarcarTodos">Marcar Todos</ion-label>
        <ion-icon name="checkmark-circle" *ngIf="flgMarcarTodos"></ion-icon>
        <ion-label *ngIf="flgMarcarTodos">Desmarcar Todos</ion-label>
    </ion-chip> 
    <ion-list *ngFor="let acompanhamento of listaAcompanhamentosFiltrados">
        <ion-card>
            <ion-card-header>
                <ion-row> 
                    <ion-col size="2">
                        <ion-button size="small" fill="clear">
                            <ion-spinner name="lines" color="success" *ngIf="acompanhamento.flgExibeGifProcessando && acompanhamento.flgImportar"></ion-spinner>
                            <ion-icon name="checkmark-circle" *ngIf="acompanhamento.flgImportadoSucesso"></ion-icon>
                            <ion-checkbox slot="start" [(ngModel)]="acompanhamento.flgImportar" [disabled]="(!acompanhamento.flgPossuiFormulario)" *ngIf="!acompanhamento.flgExibeGifProcessando && !acompanhamento.flgImportadoSucesso"></ion-checkbox>
                        </ion-button>                
                    </ion-col>
                    <ion-col size="10">
                        <ion-card-title><span [innerHTML]="acompanhamento.beneficiario.nomeBeneficiario"></span></ion-card-title>
                    </ion-col>                                
                </ion-row>
            </ion-card-header>           
            <ion-card-content class="card-conteudo">      
                <ion-row>
                  <ion-col>
                    <span class="texto-card-label">Carteira: </span><span class="texto-card-text" [innerHTML]="acompanhamento.beneficiario.carteiraBeneficiario"></span>
                    <br>
                    <span class="texto-card-label">Senha: </span><span class="texto-card-text" [innerHTML]="acompanhamento.senhaAutorizacao.senha"></span>
                    <br>
                    <span class="texto-card-label">Formulário: </span><span class="texto-card-text" [innerHTML]="acompanhamento.configFormulario.nomeConfigFormulario"></span>
                    <br>
                    <span class="texto-card-label">Usuário: </span><span class="texto-card-text" [innerHTML]="acompanhamento.usuario.nome"></span>
                    <br>
                    <span class="texto-card-label">Status: </span><span class="texto-card-text" [innerHTML]="acompanhamento.status"></span>
                    <div *ngIf="!acompanhamento.flgPossuiFormulario">
                        <span class="texto-card-text-red">* Formulário do acompanhamento não habilitado para o usuário</span>
                    </div>
                    <div *ngIf="acompanhamento.flgExisteDispositivo">
                        <span class="texto-card-text-yellow">* Acompanhamento já existe no dispositivo e será atualizado.</span>
                    </div> 
                  </ion-col>             
                </ion-row>
            </ion-card-content>
        </ion-card>
    </ion-list>
    <ion-row *ngIf="listaAcompanhamentosFiltrados.length > 0">
        <ion-col size="12" class="ion-text-center">
            <ion-button id="btnImportar" expand="block" size="large" (click)="confirmarImportarAcompanhamento()">Importar</ion-button>
        </ion-col>
    </ion-row>
</ion-content> 